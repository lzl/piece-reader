<template name="follow">
  <div class="row">
    {{> followForm}}
    <div class="hr"></div>
  </div>

  <div class="row">
    {{> followPieces}}
  </div>
</template>

<template name="followPieces">
  <ul class="list-group">
    {{#if hasPiece}}
      {{#each pieces}}
        <li class="list-group-item">{{owner}}: {{content}}</li>
      {{/each}}
    {{else}}
      <li class="list-group-item">Fetching pieces...</li>
    {{/if}}
  </ul>
</template>

<template name="followForm">
  <form id="subscribe" class="form-inline">
    <div class="form-group">
      <label class="sr-only" for="url">URL</label>
      <input type="text" class="form-control" id="url" name="url" placeholder="{{URL}}" disabled>
    </div>
    <div class="form-group">
      <label class="sr-only" for="userId">User ID</label>
      <input type="text" class="form-control" id="userId" name="userId" placeholder="{{userId}}" disabled>
    </div>

    {{#if currentUser}}
      {{#clonesWrapper}}
        {{#subsWrapper}}
          {{> followButton}}
        {{/subsWrapper}}
      {{/clonesWrapper}}
    {{else}}
      <button type="button" class="btn btn-primary" disabled>Please sign in â†–</button>
    {{/if}}
  </form>
</template>

<template name="followButton">
  {{#if following}}
    {{#if unfollow}}
      <button type="button" class="btn btn-danger" data-action="unfollow">Unfollow</button>
    {{else}}
      <button type="button" class="btn btn-primary" data-action="following">Following</button>
    {{/if}}
  {{else}}
    <button type="button" class="btn btn-primary" data-action="follow">Follow</button>
  {{/if}}
</template>
